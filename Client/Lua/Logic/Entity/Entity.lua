--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by shenyi.
--- DateTime: 2020/8/13
-----------------------------------------------------------
------@class AOIStatus
local status = {
    ---状态
    pos_x = nil,
    pos_y = nil,
    pos_z = nil,
    forward = nil,
}
------@class AOIData
local aoiData =
{
    aoiId = nil,
    paramId = nil,--- 对于玩家来说是roleId, 对于配表单位来说是elementId
    modelId = nil,
    type = nil,
    name = nil,
    ---@type AOIStatus
    status = nil,

    ---服务端用，标记有没有修改
    dirty = false
}
----------------------------------------------------------


---@class Entity:Updatable
Entity = BaseClass("Entity", Updatable)
-----------------------------------------------------------
---@param aoiData AOIData
function Entity:ctor(aoiData)
    local sceneId = RoleModel.RoleData.sceneId
    ---@type AOIData
    self.aoiData = aoiData
    ---@type Game.EntityBehavior
    self.behavior = EntityBehaviorManager.CreateEntity(
            sceneId,
            aoiData.aoiId,
            aoiData.modelId,
            { x = aoiData.status.pos_x, y = aoiData.status.pos_y, z = aoiData.status.pos_z },
            aoiData.status.forward,
            aoiData.type,
            function(components)
                coroutine.start(function()
                    self.animComp = components[0]
                    self.rotateComp = components[1]
                    self:OnBodyCreate(components)
                end)
            end)
    ---@type UnityEngine.GameObject
    self.gameObject = self.behavior.gameObject
    ---@type UnityEngine.Transform
    self.transform = self.behavior.transform
end

---@ 实体元素创建的时候回调
function Entity:OnBodyCreate(components)

end

function Entity:dtor()
    self.behavior:RemoveAllListeners()
    EntityBehaviorManager.DestroyEntity(self.aoiData.uid)
end